# Depot Heating Model

This project provides a simplified thermal analysis of a railway depot as a precursor to more detailed Computational Fluid Dynamics (CFD) modeling. The results and insights from this model are intended to inform and guide subsequent CFD studies by establishing baseline heating requirements and understanding key thermal behaviors.

This project simulates the thermal behavior of a railway depot to estimate the number of heating panels required to maintain a target indoor temperature under various conditions. The model accounts for heat losses through the building envelope, ventilation, and the effects of thermal mass from air and (optionally) the ground.

## Features
- Models heat transfer through walls, windows, shutters, roof, and floor
- Includes ventilation heat loss based on air changes per hour (ACH)
- Considers both insulated and uninsulated floor scenarios
- Calculates the number of heating panels needed to reach a target temperature
- Visualizes indoor temperature rise over time

## Requirements
- Python 3.x
- numpy
- matplotlib

Install dependencies with:
```bash
pip install numpy matplotlib
```ca

## Usage
1. Edit `depotHeatingModel.py` to set your desired parameters (dimensions, U-values, ventilation rate, etc.).
2. Set `ground_insulation = True` for an insulated floor (modern slab), or `False` for an uninsulated floor.
3. Run the script:
```bash
python depotHeatingModel.py
```

## Input Parameters
- **Depot dimensions:** length, width, height (meters)
- **Envelope U-values:**
  - Walls, windows, shutters, roof, and floor (W/(m²·K))
  - Floor U-value is set to 0.2 for insulated, 1.5 for uninsulated
- **Thermal mass:**
  - Air is always included
  - Ground is included only if `ground_insulation = False`
- **Ventilation:** Air changes per hour (ACH)
- **Heating panels:**
  - Power per panel (W)
  - Range of panel counts to test
- **Temperatures:**
  - Initial, outside, and target indoor temperature (°C)

## Insulated vs. Uninsulated Floor
- **Insulated floor:**
  - `U_floor = 0.2` W/(m²·K)
  - Ground thermal mass is excluded
- **Uninsulated floor:**
  - `U_floor = 1.5` W/(m²·K)
  - Ground thermal mass is included (using kappa value for dense concrete)

## Output
- **Plot:** Indoor temperature vs. time for each tested panel configuration
- **Text summary:** Number of panels required to reach the target temperature

## Example Output
```
Heating Panel Summary:
- Panel 6 (36266 W): Panels needed = 24
...
```

## Interpretation
Use the plot and summary to determine the minimum number of panels needed for your scenario. Adjust parameters as needed to explore different insulation or ventilation strategies.

---

## Mathematical Model (External Material)

The following section provides a detailed description of the mathematical model underlying this project. This is included as external material for reference and for users interested in the theoretical background.

The code numerically solves a **first-order ordinary differential equation (ODE)** that describes the energy balance of the depot. The fundamental principle is the first law of thermodynamics: the change in the internal energy of the system is equal to the net heat added to the system.

The core equation for the indoor temperature ($T_{in}$) over time ($t$) is:

$$\frac{dT_{in}}{dt} = \frac{Q_{net}}{C_{total}}$$

### 1. Total Thermal Capacity ($C_{total}$)
This represents the system's resistance to temperature change. In the model, it's the sum of the thermal capacity of the air and the ground.

$$C_{total} = C_{air} + C_{ground}$$

- **Air Thermal Capacity ($C_{air}$):**
  $$C_{air} = V_{air} \cdot \rho_{air} \cdot c_{p,air}$$
- **Ground Thermal Capacity ($C_{ground}$):**
  The assumed value discussed above.

### 2. Net Heat Flow Rate ($Q_{net}$)
This is the rate at which energy is added to the system (in Watts, or Joules per second). It's the difference between the heat generated by the panels and the heat lost to the environment.

$$Q_{net} = Q_{panels} - Q_{loss}$$

- **Heating Power ($Q_{panels}$):**
  $$Q_{panels} = N_{panels} \cdot P_{panel}$$
- **Total Heat Loss ($Q_{loss}$):**
  $$Q_{loss} = Q_{conduction} + Q_{ventilation}$$

### 3. Heat Loss Mechanisms
Heat loss is driven by the temperature difference between the inside and outside, $\Delta T = T_{in} - T_{out}$.

- **Conduction Loss ($Q_{conduction}$):**
  $$Q_{conduction} = (\sum_{i} U_i A_i) \cdot \Delta T$$
  $$\sum U_i A_i = (U_{solid}A_{solid} + U_{win}A_{win} + U_{shut}A_{shut} + U_{roof}A_{roof} + U_{floor}A_{floor})$$

- **Ventilation Loss ($Q_{ventilation}$):**
  $$Q_{ventilation} = \dot{m}_{air} \cdot c_{p,air} \cdot \Delta T$$
  Where the mass flow rate of air ($\dot{m}_{air}$) is determined by the Air Changes per Hour (ACH) and the building volume ($V_{air}$):
  $$\dot{m}_{air} = \frac{ACH \cdot V_{air}}{3600} \cdot \rho_{air}$$

### 4. Numerical Solution
The code does not solve the differential equation analytically. Instead, it uses the **Euler method**, a numerical technique to approximate the solution over discrete time steps ($\Delta t$). The temperature at the next time step ($T_{t+1}$) is found from the temperature at the current time step ($T_t$):

$$T_{t+1} = T_t + \Delta T_{in}$$

Where the change in temperature is calculated as:

$$\Delta T_{in} = \frac{Q_{net} \cdot \Delta t}{C_{total}}$$

This is exactly what the simulation loop implements:

`temps[t] = temps[t-1] + (net_heat * time_step) / total_thermal_capacity`

This is a valid and common approach for this type of thermal simulation.

---

For questions or improvements, please open an issue or submit a pull request. 